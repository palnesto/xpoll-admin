
src/hooks/useApiQuery.ts
------------------------
import { useQuery, UseQueryOptions } from "@tanstack/react-query";
import apiInstance, { BASE_URL } from "../api/queryClient";
import { trimUrl } from "@/utils/formatter";

export const useApiQuery = (
  route: string,
  options?: UseQueryOptions<any, any>
) => {
  console.log("registering query", trimUrl(route));
  return useQuery({
    queryKey: [trimUrl(route)],
    queryFn: async () => {
      const response = await apiInstance.get(`${BASE_URL}${route}`);
      return response;
    },
    ...options,
  });
};


src/hooks/useApiMutation.ts
---------------------------
import { useMutation, UseMutationOptions } from "@tanstack/react-query";
import apiInstance from "../api/queryClient";
import { appToast } from "@/utils/toast";

export const useApiMutation = <TData, TResponse>({
  route,
  method = "POST",
  onSuccess,
  onError,
}: {
  route: string;
  method: "POST" | "PATCH" | "DELETE" | "PUT"; // Restrict method to specific HTTP verbs
  options?: UseMutationOptions<TResponse, Error, TData>;
  onSuccess?: (data: TResponse) => void;
  onError?: (error: Error) => void;
}) => {
  return useMutation({
    mutationFn: async (newData) => {
      if (method === "POST") {
        const response = await apiInstance.post(route, newData);
        return response.data;
      } else if (method === "PATCH") {
        const response = await apiInstance.patch(route, newData);
        return response.data;
      } else if (method === "PUT") {
        const response = await apiInstance.put(route, newData);
        return response.data;
      } else if (method === "DELETE") {
        const response = await apiInstance.delete(route, { data: newData }); // Fixed DELETE syntax for sending body
        return response.data;
      }
    },
    onSuccess: (data) => {
      onSuccess?.(data);
    },
    onError: (error: any) => {
      // Extract error message
      const errorMessage =
        error?.response?.data?.message || "An unexpected error occurred";
      appToast.error(errorMessage); // Show error toast
      onError?.(error);
    },
  });
};
